{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACvB,gSACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,mKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/sheet.tsx"],"sourcesContent":["\n\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AASA,MAAM,QAAQ,qKAAA,CAAA,OAAmB;AAEjC,MAAM,eAAe,qKAAA,CAAA,UAAsB;AAE3C,MAAM,aAAa,qKAAA,CAAA,QAAoB;AAEvC,MAAM,cAAc,qKAAA,CAAA,SAAqB;AAEzC,MAAM,6BAAe,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,EAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,qKAAA,CAAA,UAAsB;QACrB,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;KAVH;AAaN,aAAa,WAAW,GAAG,qKAAA,CAAA,UAAsB,CAAC,WAAW;AAE7D,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB,oMACA;IACE,UAAU;QACR,MAAM;YACJ,KAAK;YACL,QACE;YACF,MAAM;YACN,OACE;QACJ;IACF;IACA,iBAAiB;QACf,MAAM;IACR;AACF;AAOF,MAAM,6BAAe,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGlC,CAAC,EAAE,OAAO,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpD,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,qKAAA,CAAA,UAAsB;gBACrB,KAAK;gBACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;oBAAE;gBAAK,IAAI;gBACtC,GAAG,KAAK;;oBAER;kCACD,6LAAC,qKAAA,CAAA,QAAoB;wBAAC,WAAU;;0CAC9B,6LAAC,+LAAA,CAAA,IAAC;gCAAC,WAAU;;;;;;0CACb,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,aAAa,WAAW,GAAG,qKAAA,CAAA,UAAsB,CAAC,WAAW;AAE7D,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,oDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,YAAY,WAAW,GAAG;AAE1B,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,qKAAA,CAAA,QAAoB;QACnB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,yCAAyC;QACtD,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG,qKAAA,CAAA,QAAoB,CAAC,WAAW;AAEzD,MAAM,iCAAmB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,qKAAA,CAAA,cAA0B;QACzB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,qKAAA,CAAA,cAA0B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/popover.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,UAAU,sKAAA,CAAA,OAAqB;AAErC,MAAM,iBAAiB,sKAAA,CAAA,UAAwB;AAE/C,MAAM,+BAAiB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC5D,6LAAC,sKAAA,CAAA,SAAuB;kBACtB,cAAA,6LAAC,sKAAA,CAAA,UAAwB;YACvB,KAAK;YACL,OAAO;YACP,YAAY;YACZ,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,8aACA;YAED,GAAG,KAAK;;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,sKAAA,CAAA,UAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/notification-bell.tsx"],"sourcesContent":["\n\"use client\"\n\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\nimport { Button } from \"@/components/ui/button\"\nimport { Bell, Info, AlertTriangle, DollarSign } from \"lucide-react\"\nimport type { Notification } from \"@/lib/types\"\nimport { formatDistanceToNow } from \"date-fns\"\nimport { cn } from \"@/lib/utils\"\nimport { useTranslation } from \"@/hooks/use-translation\"\n\ninterface NotificationBellProps {\n  notifications: Notification[],\n  onOpen: () => void,\n}\n\nconst notificationIcons = {\n  deposit: <DollarSign className=\"h-4 w-4 text-green-500\" />,\n  alert: <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />,\n  info: <Info className=\"h-4 w-4 text-blue-500\" />,\n}\n\nexport function NotificationBell({ notifications, onOpen }: NotificationBellProps) {\n  const unreadCount = notifications.filter(n => !n.isRead).length;\n  const { t } = useTranslation();\n\n  return (\n    <Popover onOpenChange={(open) => {\n        if (open) onOpen();\n    }}>\n      <PopoverTrigger asChild>\n        <Button variant=\"ghost\" size=\"icon\" className=\"relative\">\n          <Bell className=\"h-5 w-5\"/>\n          {unreadCount > 0 && (\n            <span className=\"absolute top-1 right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-xs text-white\">\n              {unreadCount}\n            </span>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-screen max-w-[320px] sm:max-w-sm p-0\">\n        <div className=\"p-4 font-semibold border-b\">\n          {t('notifications.title')}\n        </div>\n        <div className=\"max-h-96 overflow-y-auto\">\n            {notifications.length === 0 ? (\n                <p className=\"p-4 text-sm text-muted-foreground\">{t('notifications.noNotifications')}</p>\n            ) : (\n                notifications.map(n => (\n                    <div key={n.id} className={cn(\n                        \"flex items-start gap-4 p-4 border-b last:border-b-0\",\n                        !n.isRead && \"bg-blue-50 dark:bg-blue-900/20\"\n                    )}>\n                       <div className=\"mt-1\">\n                         {notificationIcons[n.type]}\n                       </div>\n                       <div className=\"flex-1 space-y-1\">\n                            <p className=\"text-sm\">{n.message}</p>\n                            <p className=\"text-xs text-muted-foreground\">\n                                {n.timestamp ? formatDistanceToNow(new Date(n.timestamp), { addSuffix: true }) : t('notifications.justNow')}\n                            </p>\n                       </div>\n                    </div>\n                ))\n            )}\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n"],"names":[],"mappings":";;;;AAGA;AAKA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;;;AAZA;;;;;;;AAmBA,MAAM,oBAAoB;IACxB,uBAAS,6LAAC,qNAAA,CAAA,aAAU;QAAC,WAAU;;;;;;IAC/B,qBAAO,6LAAC,2NAAA,CAAA,gBAAa;QAAC,WAAU;;;;;;IAChC,oBAAM,6LAAC,qMAAA,CAAA,OAAI;QAAC,WAAU;;;;;;AACxB;AAEO,SAAS,iBAAiB,EAAE,aAAa,EAAE,MAAM,EAAyB;;IAC/E,MAAM,cAAc,cAAc,MAAM,CAAC,CAAA,IAAK,CAAC,EAAE,MAAM,EAAE,MAAM;IAC/D,MAAM,EAAE,CAAC,EAAE,GAAG,CAAA,GAAA,sIAAA,CAAA,iBAAc,AAAD;IAE3B,qBACE,6LAAC,sIAAA,CAAA,UAAO;QAAC,cAAc,CAAC;YACpB,IAAI,MAAM;QACd;;0BACE,6LAAC,sIAAA,CAAA,iBAAc;gBAAC,OAAO;0BACrB,cAAA,6LAAC,qIAAA,CAAA,SAAM;oBAAC,SAAQ;oBAAQ,MAAK;oBAAO,WAAU;;sCAC5C,6LAAC,qMAAA,CAAA,OAAI;4BAAC,WAAU;;;;;;wBACf,cAAc,mBACb,6LAAC;4BAAK,WAAU;sCACb;;;;;;;;;;;;;;;;;0BAKT,6LAAC,sIAAA,CAAA,iBAAc;gBAAC,WAAU;;kCACxB,6LAAC;wBAAI,WAAU;kCACZ,EAAE;;;;;;kCAEL,6LAAC;wBAAI,WAAU;kCACV,cAAc,MAAM,KAAK,kBACtB,6LAAC;4BAAE,WAAU;sCAAqC,EAAE;;;;;mCAEpD,cAAc,GAAG,CAAC,CAAA,kBACd,6LAAC;gCAAe,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACxB,uDACA,CAAC,EAAE,MAAM,IAAI;;kDAEd,6LAAC;wCAAI,WAAU;kDACZ,iBAAiB,CAAC,EAAE,IAAI,CAAC;;;;;;kDAE5B,6LAAC;wCAAI,WAAU;;0DACV,6LAAC;gDAAE,WAAU;0DAAW,EAAE,OAAO;;;;;;0DACjC,6LAAC;gDAAE,WAAU;0DACR,EAAE,SAAS,GAAG,CAAA,GAAA,sJAAA,CAAA,sBAAmB,AAAD,EAAE,IAAI,KAAK,EAAE,SAAS,GAAG;oDAAE,WAAW;gDAAK,KAAK,EAAE;;;;;;;;;;;;;+BAVrF,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;AAoBlC;GA/CgB;;QAEA,sIAAA,CAAA,iBAAc;;;KAFd","debugId":null}},
    {"offset": {"line": 476, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/use-account.ts"],"sourcesContent":["\n\"use client\";\n\nimport { useState, useEffect, useCallback, useRef } from \"react\";\nimport { \n  getFirestore, \n  doc, \n  onSnapshot, \n  collection, \n  query, \n  orderBy, \n  runTransaction,\n  serverTimestamp,\n  getDocs,\n  writeBatch,\n  setDoc,\n  Timestamp,\n  where,\n  addDoc,\n  limit,\n  updateDoc\n} from \"firebase/firestore\";\nimport type { Account, Transaction, TransactionFormData, Notification, FrequentRecipient } from \"@/lib/types\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { auth } from \"@/lib/firebase\";\n\nconst LOW_BALANCE_THRESHOLD = 100;\n\nexport async function generateUniqueAccountNumber(db: any): Promise<string> {\n    let accountNumber;\n    let isUnique = false;\n    while (!isUnique) {\n        accountNumber = Math.floor(100000000 + Math.random() * 900000000).toString();\n        const q = query(collection(db, \"accounts\"), where(\"accountNumber\", \"==\", accountNumber));\n        const querySnapshot = await getDocs(q);\n        if (querySnapshot.empty) {\n            isUnique = true;\n        }\n    }\n    return accountNumber!;\n}\n\nexport function useAccount(userId?: string) {\n  const { toast } = useToast();\n  const [account, setAccount] = useState<Account>({ \n    id: \"\", \n    holderName: \"Guest\", \n    accountNumber: \"000000000\",\n    balance: 0,\n    notificationPreferences: { deposits: true, alerts: true, info: true }\n  });\n  const [transactions, setTransactions] = useState<Transaction[]>([]);\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [frequentRecipients, setFrequentRecipients] = useState<FrequentRecipient[]>([]);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const notificationsRef = useRef<Notification[]>([]);\n  const isInitialLoad = useRef(true);\n\n\n  const db = getFirestore();\n\n  useEffect(() => {\n    notificationsRef.current = notifications;\n  }, [notifications]);\n\n  useEffect(() => {\n    if (!userId || !db) {\n        setIsLoading(false);\n        return;\n    }\n    \n    setIsLoading(true);\n\n    const accountRef = doc(db, \"accounts\", userId);\n    const unsubscribeAccount = onSnapshot(accountRef, async (docSnap) => {\n      if (docSnap.exists()) {\n        const data = docSnap.data() as Account;\n        // Ensure notificationPreferences has defaults\n        if (!data.notificationPreferences) {\n          data.notificationPreferences = { deposits: true, alerts: true, info: true };\n        }\n        if (!data.accountNumber) {\n            const newAccountNumber = await generateUniqueAccountNumber(db);\n            await updateDoc(accountRef, { accountNumber: newAccountNumber });\n            data.accountNumber = newAccountNumber;\n        }\n        setAccount(data);\n      } else {\n        // Fallback: If account doesn't exist (e.g., failed during signup), create one.\n        // This is now a secondary measure, as account creation should happen at signup.\n        const user = auth?.currentUser;\n        console.log(\"Account not found for user, creating a fallback account.\");\n        const newAccountNumber = await generateUniqueAccountNumber(db);\n        const newAccount: Account = {\n            id: userId,\n            holderName: user?.email || \"New User\",\n            accountNumber: newAccountNumber,\n            balance: 1000,\n            notificationPreferences: { deposits: true, alerts: true, info: true }\n        };\n        await setDoc(accountRef, newAccount);\n        setAccount(newAccount);\n      }\n    }, (error) => {\n        console.error(\"Error listening to account:\", error);\n        toast({ variant: \"destructive\", title: \"Error\", description: \"Could not load account data.\"});\n    });\n\n    const transactionsQuery = query(\n        collection(db, \"transactions\"), \n        where(\"accountId\", \"==\", userId),\n        orderBy(\"timestamp\", \"desc\")\n    );\n    const unsubscribeTransactions = onSnapshot(transactionsQuery, async (querySnapshot) => {\n        const txs: Transaction[] = [];\n        querySnapshot.forEach((doc) => {\n            const data = doc.data();\n            txs.push({\n                ...data,\n                id: doc.id,\n                timestamp: (data.timestamp as Timestamp)?.toDate().toISOString(),\n            } as Transaction);\n        });\n        setTransactions(txs);\n        \n        // Analyze for frequent recipients\n        const recipientCounts = txs\n            .filter(tx => tx.type === 'withdrawal' && tx.recipient)\n            .reduce((acc, tx) => {\n                const recipient = tx.recipient!;\n                acc[recipient] = (acc[recipient] || 0) + 1;\n                return acc;\n            }, {} as Record<string, number>);\n\n        const sortedRecipients = Object.entries(recipientCounts)\n            .sort(([, a], [, b]) => b - a)\n            .slice(0, 3)\n            .map(([accountNumber]) => accountNumber);\n        \n        if (sortedRecipients.length > 0) {\n            const q = query(collection(db, \"accounts\"), where(\"accountNumber\", \"in\", sortedRecipients));\n            const recipientDocs = await getDocs(q);\n            const recipientData: Record<string, string> = {};\n            recipientDocs.forEach(doc => {\n                const data = doc.data();\n                recipientData[data.accountNumber] = data.holderName;\n            });\n\n            const frequentWithNames = sortedRecipients.map(accountNumber => ({\n                accountNumber,\n                name: recipientData[accountNumber] || \"Unknown User\"\n            }));\n            \n            setFrequentRecipients(frequentWithNames);\n        } else {\n            setFrequentRecipients([]);\n        }\n\n\n        setIsLoading(false);\n    }, (error) => {\n        console.error(\"Error listening to transactions:\", error);\n        toast({ variant: \"destructive\", title: \"Error\", description: \"Could not load transaction history.\"});\n        setIsLoading(false);\n    });\n\n    const notificationsQuery = query(\n      collection(db, \"notifications\"),\n      where(\"userId\", \"==\", userId),\n      orderBy(\"timestamp\", \"desc\"),\n      limit(20)\n    );\n    const unsubscribeNotifications = onSnapshot(notificationsQuery, (querySnapshot) => {\n      const notifs: Notification[] = [];\n      querySnapshot.forEach((doc) => {\n        const data = doc.data();\n        notifs.push({\n          id: doc.id,\n          ...data,\n          timestamp: (data.timestamp as Timestamp)?.toDate().toISOString(),\n        } as Notification);\n      });\n      setNotifications(notifs);\n\n      if (isInitialLoad.current) {\n        isInitialLoad.current = false;\n        return;\n      }\n      \n      const previousNotifications = notificationsRef.current;\n      const newNotifications = notifs.filter(n => !previousNotifications.some(pn => pn.id === n.id));\n\n      if (newNotifications.length > 0) {\n        const latestNotification = newNotifications[0]; // Assuming newest is first\n        if (latestNotification.type !== 'info') { // Don't toast admin announcements\n             toast({\n                title: latestNotification.type.charAt(0).toUpperCase() + latestNotification.type.slice(1),\n                description: latestNotification.message\n            });\n        }\n      }\n\n    }, (error) => {\n      console.error(\"Error listening to notifications:\", error);\n      toast({ variant: \"destructive\", title: \"Error\", description: \"Could not load notifications.\"});\n    });\n\n\n    return () => {\n        unsubscribeAccount();\n        unsubscribeTransactions();\n        unsubscribeNotifications();\n    }\n  }, [userId, db, toast]);\n\n\n  const handleAddTransaction = async (data: TransactionFormData): Promise<void> => {\n    if (!userId || !db) {\n      toast({ variant: 'destructive', title: \"Error\", description: \"Not connected to the database.\" });\n      return;\n    }\n\n    setIsProcessing(true);\n    \n    try {\n        await runTransaction(db, async (transaction) => {\n            const senderAccountRef = doc(db, \"accounts\", userId);\n            const senderAccountDoc = await transaction.get(senderAccountRef);\n\n            if (!senderAccountDoc.exists()) throw new Error(\"Your account does not exist!\");\n            \n            const senderData = senderAccountDoc.data() as Account;\n            const senderBalance = senderData.balance;\n            const newSenderBalance = senderBalance - data.amount;\n\n            if (newSenderBalance < 0) throw new Error(\"Insufficient funds.\");\n\n            // Handle recipient if it's a transfer\n            if (data.recipient) {\n                // Sanitize recipient input to handle formatted account numbers\n                const sanitizedRecipient = data.recipient.replace(/[-\\s]/g, '');\n                \n                if (sanitizedRecipient === senderData.accountNumber) {\n                    throw new Error(\"You cannot send money to yourself.\");\n                }\n                \n                const isAccountNumber = /^\\d{9}$/.test(sanitizedRecipient);\n\n                if (!isAccountNumber) {\n                    throw new Error(`Invalid account number format: \"${data.recipient}\". Please enter a 9-digit number.`);\n                }\n\n                const recipientQuery = query(collection(db, \"accounts\"), where(\"accountNumber\", \"==\", sanitizedRecipient), limit(1));\n                const recipientSnapshot = await getDocs(recipientQuery);\n\n                if (recipientSnapshot.empty) {\n                    throw new Error(`Recipient account \"${data.recipient}\" not found.`);\n                }\n                \n                const recipientDoc = recipientSnapshot.docs[0];\n                const recipientData = recipientDoc.data() as Account;\n                const recipientAccountRef = recipientDoc.ref;\n                const recipientBalance = recipientData.balance;\n                const newRecipientBalance = recipientBalance + data.amount;\n\n                transaction.update(recipientAccountRef, { balance: newRecipientBalance });\n\n                const recipientTransactionRef = doc(collection(db, \"transactions\"));\n                transaction.set(recipientTransactionRef, {\n                    accountId: recipientDoc.id,\n                    amount: data.amount,\n                    description: `Received from ${senderData.holderName}`,\n                    type: 'deposit',\n                    timestamp: serverTimestamp(),\n                    sender: senderData.holderName\n                });\n                \n                if (recipientData.notificationPreferences?.deposits) {\n                    const recipientNotificationRef = doc(collection(db, \"notifications\"));\n                    transaction.set(recipientNotificationRef, {\n                        userId: recipientDoc.id,\n                        message: `You received $${data.amount.toFixed(2)} from ${senderData.holderName}.`,\n                        type: 'deposit',\n                        isRead: false,\n                        timestamp: serverTimestamp(),\n                    });\n                }\n            }\n\n            // Update sender's account\n            transaction.update(senderAccountRef, { balance: newSenderBalance });\n\n            // Create withdrawal transaction for sender\n            const newTransactionRef = doc(collection(db, \"transactions\"));\n            transaction.set(newTransactionRef, {\n                accountId: userId,\n                amount: data.amount,\n                description: data.description,\n                type: 'withdrawal',\n                timestamp: serverTimestamp(),\n                recipient: data.recipient || null,\n            });\n\n\n            if (newSenderBalance < LOW_BALANCE_THRESHOLD && senderData.notificationPreferences?.alerts) {\n                const senderNotificationRef = doc(collection(db, \"notifications\"));\n                transaction.set(senderNotificationRef, {\n                    userId: userId,\n                    message: `Your account balance is low: $${newSenderBalance.toFixed(2)}.`,\n                    type: 'alert',\n                    isRead: false,\n                    timestamp: serverTimestamp(),\n                });\n            }\n        });\n\n        toast({\n            title: \"Transaction Successful\",\n            description: \"Your transaction has been processed.\",\n        });\n\n    } catch (e: any) {\n        console.error(\"Transaction failed: \", e);\n        toast({\n            variant: \"destructive\",\n            title: \"Transaction Failed\",\n            description: e.message || \"An unexpected error occurred.\",\n        });\n        throw e;\n    } finally {\n        setIsProcessing(false);\n    }\n  };\n\n  const updateAccountDetails = async (details: Partial<Account>) => {\n    if (!userId || !db) {\n        throw new Error(\"User is not authenticated or database is not available.\");\n    }\n    const accountRef = doc(db, \"accounts\", userId);\n    await updateDoc(accountRef, details);\n  };\n\n  const markNotificationsAsRead = useCallback(async () => {\n    if (!userId || !db) return;\n    const unreadNotifications = notifications.filter(n => !n.isRead);\n    if (unreadNotifications.length === 0) return;\n\n    const batch = writeBatch(db);\n    unreadNotifications.forEach(n => {\n      const notifRef = doc(db, \"notifications\", n.id);\n      batch.update(notifRef, { isRead: true });\n    });\n\n    try {\n      await batch.commit();\n    } catch (error) {\n      console.error(\"Error marking notifications as read:\", error);\n    }\n  }, [userId, db, notifications]);\n\n  return {\n    account,\n    transactions,\n    notifications,\n    frequentRecipients,\n    isProcessing,\n    isLoading,\n    handleAddTransaction,\n    markNotificationsAsRead,\n    updateAccountDetails\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 878, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACkC;IACrC,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf;KAVS","debugId":null}},
    {"offset": {"line": 908, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28authed%29/layout.tsx"],"sourcesContent":["\n'use client';\n\nimport Link from 'next/link';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { signOut } from 'firebase/auth';\nimport { auth } from '@/lib/firebase';\nimport { useAuth } from '@/hooks/use-auth';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport {\n  LayoutDashboard,\n  LogOut,\n  QrCode,\n  Landmark,\n  Menu,\n  User,\n  History,\n  Settings,\n  ArrowRightLeft\n} from 'lucide-react';\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n  SheetTrigger,\n} from '@/components/ui/sheet';\nimport { useState, useMemo } from 'react';\nimport { NotificationBell } from '@/components/notification-bell';\nimport { useAccount } from '@/hooks/use-account';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { useTranslation } from '@/hooks/use-translation';\n\n\nexport default function AuthedLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const { user, isLoading: isAuthLoading } = useAuth();\n  const { notifications, markNotificationsAsRead, isLoading: isAccountLoading } = useAccount(user?.uid);\n  const router = useRouter();\n  const pathname = usePathname();\n  const [isSheetOpen, setIsSheetOpen] = useState(false);\n  const { t } = useTranslation();\n\n  const navItems = useMemo(() => [\n    { href: '/dashboard', label: t('nav.dashboard'), icon: LayoutDashboard },\n    { href: '/transfer', label: t('nav.transfer'), icon: ArrowRightLeft },\n    { href: '/settings', label: t('nav.settings'), icon: Settings },\n  ], [t]);\n\n  const currentPage = useMemo(() => {\n    let current = navItems.find(item => item.href === pathname);\n    if (!current) {\n        // Check for pages not in the main nav\n        if (pathname.startsWith('/transactions')) {\n            return { label: t('transactions.title') };\n        }\n        if (pathname.startsWith('/my-qr')) {\n            return { label: t('dashboard.myQr.title') };\n        }\n        if (pathname.startsWith('/qr-pay')) {\n            return { label: t('dashboard.scanQr.title') };\n        }\n        return { label: ' ' };\n    }\n    return current;\n  }, [pathname, navItems, t]);\n\n  const handleLogout = async () => {\n    await signOut(auth);\n    router.push('/login');\n  };\n  \n  if (isAuthLoading || isAccountLoading) {\n    return (\n      <div className=\"flex min-h-screen w-full bg-background\">\n        <div className=\"hidden md:flex md:w-[240px] flex-col gap-4 border-r bg-background p-4\">\n            <Skeleton className=\"h-8 w-32\" />\n            <div className=\"flex-1 space-y-2 mt-4\">\n              <Skeleton className=\"h-10 w-full\" />\n              <Skeleton className=\"h-10 w-full\" />\n              <Skeleton className=\"h-10 w-full\" />\n            </div>\n        </div>\n        <div className=\"flex-1 p-6\">\n            <Skeleton className=\"h-full w-full\" />\n        </div>\n      </div>\n    )\n  }\n\nfunction NavLink({\n  href,\n  label,\n  icon: Icon,\n  isMobile = false,\n  onClose,\n}: {\n  href: string;\n  label:string;\n  icon: React.ElementType;\n  isMobile?: boolean;\n  onClose?: () => void;\n}) {\n  const isActive = pathname === href;\n\n  return (\n    <Link\n      href={href}\n      onClick={onClose}\n      className={cn(\n        'flex items-center gap-3 rounded-lg px-3 py-2 text-muted-foreground transition-all hover:text-primary',\n        isActive && 'bg-primary/10 text-primary font-semibold',\n        isMobile && 'text-lg'\n      )}\n    >\n      <Icon className=\"h-5 w-5\" />\n      {label}\n    </Link>\n  );\n}\n\n  return (\n    <div className=\"grid min-h-screen w-full md:grid-cols-[240px_1fr] bg-background\">\n      {/* Desktop Sidebar */}\n      <aside className=\"hidden border-r bg-card md:block\">\n        <div className=\"flex h-full max-h-screen flex-col gap-2\">\n          <div className=\"flex h-14 items-center border-b px-4 lg:h-[60px] lg:px-6\">\n            <Link href=\"/\" className=\"flex items-center gap-2 font-semibold\">\n              <Landmark className=\"h-6 w-6 text-primary\" />\n              <span className=\"text-xl\">FinSim</span>\n            </Link>\n          </div>\n          <nav className=\"flex-1 grid items-start px-2 text-sm font-medium lg:px-4 py-4\">\n            {navItems.map((item) => (\n              <NavLink key={item.href} {...item} />\n            ))}\n          </nav>\n          <div className=\"mt-auto p-4\">\n             <Button variant=\"ghost\" onClick={handleLogout} className=\"w-full justify-start\">\n              <LogOut className=\"mr-2 h-4 w-4\" />\n              {t('logout')}\n            </Button>\n          </div>\n        </div>\n      </aside>\n      \n      <div className=\"flex flex-col\">\n        {/* Mobile & Desktop Header */}\n        <header className=\"flex h-14 items-center gap-4 border-b bg-background/80 backdrop-blur-sm px-4 lg:h-[60px] lg:px-6 sticky top-0 z-30\">\n            {/* Mobile Nav Trigger */}\n            <Sheet open={isSheetOpen} onOpenChange={setIsSheetOpen}>\n              <SheetTrigger asChild>\n                <Button variant=\"outline\" size=\"icon\" className=\"shrink-0 md:hidden\">\n                  <Menu className=\"h-5 w-5\" />\n                  <span className=\"sr-only\">Toggle navigation menu</span>\n                </Button>\n              </SheetTrigger>\n              <SheetContent side=\"left\" className=\"flex flex-col\">\n                 <SheetHeader className=\"sr-only\">\n                    <SheetTitle>Navigation Menu</SheetTitle>\n                    <SheetDescription>Main navigation links for the application.</SheetDescription>\n                 </SheetHeader>\n                 <div className=\"flex h-14 items-center border-b mb-4\">\n                    <Link href=\"/\" className=\"flex items-center gap-2 font-semibold text-lg\">\n                    <Landmark className=\"h-8 w-8 text-primary\" />\n                    <span>FinSim</span>\n                    </Link>\n                </div>\n                <nav className=\"grid gap-4 text-lg font-medium\">\n                  {navItems.map((item) => (\n                    <NavLink key={item.href} {...item} isMobile={true} onClose={() => setIsSheetOpen(false)}/>\n                  ))}\n                </nav>\n                 <div className=\"mt-auto\">\n                    <Button variant=\"ghost\" onClick={handleLogout} className=\"w-full justify-start text-lg\">\n                        <LogOut className=\"mr-3 h-5 w-5\" />\n                        {t('logout')}\n                    </Button>\n                </div>\n              </SheetContent>\n            </Sheet>\n            \n          <div className=\"w-full flex-1\">\n             <h1 className=\"font-semibold text-lg\">{currentPage.label}</h1>\n          </div>\n          \n          <div className=\"font-semibold text-sm hidden md:block\">{user?.email}</div>\n          <NotificationBell notifications={notifications} onOpen={markNotificationsAsRead} />\n        </header>\n\n        <main className=\"flex flex-1 flex-col gap-4 p-4 lg:gap-6 lg:p-6 animate-fade-in-up\">\n           {children}\n        </main>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}